<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.dgit.haru.mapper.BoardMapper">	
	<select id="selectAllBoard" resultType="BoardVO">
		select * from project_haru.view_board where dno = #{dno}
	</select>
	<select id="selectBoardByBno" resultType="BoardVO">
		select * from project_haru.view_board where bno = #{bno}
	</select>
	<select id="selectBoardByBDate" parameterType="int" resultType="BoardVO">
		select * from project_haru.view_board where year(bdate) = #{year} and month(bdate) = #{month}
	</select>

	<select id="selectBoardScrap" resultType="BoardVO">
		select b.*
		from project_haru.view_board as b 
		left join project_haru.board_scrap as s on b.bno = s.bno
		where s.uid = #{uid} order by s.stime desc 
	</select>
	
	<insert id="insertBoard" parameterType="BoardVO">
		<selectKey resultType="int" keyProperty="bno" order="AFTER">
			select last_insert_id()
		</selectKey>		
		insert into project_haru.board(bpic, bcontent, bopen, dno) 
		values(#{bpic}, #{bcontent}, #{bopen}, #{dno})
	</insert>
	
	<insert id="insertBoardToday" parameterType="BoardVO">
		insert into project_haru.board_today values(#{bno}, #{btoday})
	</insert>
	
	<update id="updateBoard" parameterType="BoardVO">
		update project_haru.board 
		set bpic = #{bpic}, bcontent = #{bcontent}, bopen = #{bopen}, dno = #{dno}, bcal = #{bcal} 
		where bno = #{bno}
	</update>
	
	<update id="updateBoardToday" parameterType="BoardVO">
		update project_haru.board_today  
		set btoday = #{btoday}  
		where bno = #{bno}
	</update>
	
	<delete id="deleteBoard" parameterType="int">
		delete from project_haru.board where bno = #{bno}
	</delete>
	<delete id="deleteBoardToday" parameterType="int">
		delete from project_haru.board_today where bno = #{bno}
	</delete>
	
	<delete id="deleteAllBoard" parameterType="int">
		delete from project_haru.board where dno=#{dno}
	</delete>
	
	<delete id="deleteAllBoardToday" parameterType="int">
		delete from project_haru.board_today where dno=#{dno}
	</delete>
	
</mapper>